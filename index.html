<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Family Insight - Dashboard</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="flex items-center justify-center min-h-screen py-10 relative overflow-x-hidden">

    <div class="fixed top-6 left-6 z-50 bg-white p-4 rounded-xl shadow-xl border border-slate-200 w-64 hidden xl:block h-[850px] overflow-y-auto hide-scrollbar">
        <h3 class="text-xs font-bold text-slate-400 uppercase mb-3 tracking-wider">Metric Control</h3>
        <div class="space-y-2 mb-6">
            <button onclick="switchMode('A')" id="btnA" class="w-full py-2 px-4 rounded-lg text-xs font-bold transition-all btn-purple text-left flex items-center gap-2">
                <i class="fa-solid fa-chart-pie w-4"></i> Plan A: Traffic (æµé‡)
            </button>
            <button onclick="switchMode('B')" id="btnB" class="w-full py-2 px-4 rounded-lg text-xs font-bold transition-all btn-inactive text-left flex items-center gap-2">
                <i class="fa-solid fa-clock w-4"></i> Plan B: Time (æ—¶é•¿)
            </button>
            <button onclick="switchMode('C')" id="btnC" class="w-full py-2 px-4 rounded-lg text-xs font-bold transition-all btn-inactive text-left flex items-center gap-2">
                <i class="fa-solid fa-bolt w-4"></i> Plan C: Active (æ´»è·ƒ)
            </button>
            <button onclick="switchMode('D')" id="btnD" class="w-full py-2 px-4 rounded-lg text-xs font-bold transition-all btn-inactive text-left flex items-center gap-2">
                <i class="fa-solid fa-users w-4"></i> Plan D: Family Photo (å…¨å®¶ç¦)
            </button>
        </div>

        <div class="border-t border-slate-100 pt-4 mb-2">
            <h3 class="text-xs font-bold text-slate-400 uppercase mb-3 tracking-wider">Story Narrator</h3>
            <div class="space-y-2">
                <button onclick="switchStory(1)" id="storyBtn1" class="w-full py-2 px-4 rounded-lg text-xs font-bold transition-all btn-orange text-left flex items-center gap-2">
                    <i class="fa-solid fa-file-lines w-4"></i> Standard (æ¸©é¦¨æ—¥è®°)
                </button>
                <button onclick="switchStory(2)" id="storyBtn2" class="w-full py-2 px-4 rounded-lg text-xs font-bold transition-all btn-inactive text-left flex items-center gap-2">
                    <i class="fa-solid fa-newspaper w-4"></i> Gossip (å…«å¦å¤´æ¡)
                </button>
                <button onclick="switchStory(3)" id="storyBtn3" class="w-full py-2 px-4 rounded-lg text-xs font-bold transition-all btn-inactive text-left flex items-center gap-2">
                    <i class="fa-solid fa-gamepad w-4"></i> Gaming (ç”µç«è§£è¯´)
                </button>
                <button onclick="switchStory(4)" id="storyBtn4" class="w-full py-2 px-4 rounded-lg text-xs font-bold transition-all btn-inactive text-left flex items-center gap-2">
                    <i class="fa-solid fa-magnifying-glass-chart w-4"></i> Detective (ç½‘ç»œä¾¦æ¢)
                </button>
                <button onclick="switchStory(5)" id="storyBtn5" class="w-full py-2 px-4 rounded-lg text-xs font-bold transition-all btn-inactive text-left flex items-center gap-2">
                    <i class="fa-solid fa-cloud-moon w-4"></i> Atmospheric (æ°›å›´æ•…äº‹)
                </button>
            </div>
        </div>
        
        <div class="border-t border-slate-100 pt-4 mb-2">
            <h3 class="text-xs font-bold text-slate-400 uppercase mb-3 tracking-wider">Vibe Style</h3>
            <div class="space-y-2">
                <button onclick="switchMode('A')" id="btnA" class="w-full py-2 px-4 rounded-lg text-xs font-bold transition-all btn-purple text-left flex items-center gap-2">
                    <i class="fa-solid fa-chart-pie w-4"></i> Traffic
                </button>
                <button onclick="switchMode('B')" id="btnB" class="w-full py-2 px-4 rounded-lg text-xs font-bold transition-all btn-inactive text-left flex items-center gap-2">
                    <i class="fa-solid fa-clock w-4"></i> Time
                </button>
                <button onclick="switchMode('C')" id="btnC" class="w-full py-2 px-4 rounded-lg text-xs font-bold transition-all btn-inactive text-left flex items-center gap-2">
                    <i class="fa-solid fa-bolt w-4"></i> Active
                </button>
                <button onclick="switchMode('D')" id="btnD" class="w-full py-2 px-4 rounded-lg text-xs font-bold transition-all btn-inactive text-left flex items-center gap-2">
                    <i class="fa-solid fa-users w-4"></i> Family Photo
                </button>
            </div>
        </div>
        
        <div class="mt-6 p-3 bg-slate-50 rounded-lg border border-slate-100 text-[10px] text-slate-400 leading-relaxed">
            <i class="fa-solid fa-info-circle mr-1"></i> Use these controls to toggle the display modes on the main device view.
        </div>
    </div>

    <div id="promptSidebar" class="fixed top-1/2 -translate-y-1/2 right-6 xl:right-20 z-40 w-96 bg-white p-6 rounded-2xl shadow-2xl border border-slate-200 opacity-0 translate-x-10 pointer-events-none transition-all duration-500 max-h-[80vh] overflow-y-auto hide-scrollbar">
        <div class="flex justify-between items-center mb-4 border-b border-slate-100 pb-2">
            <h3 class="text-xs font-bold text-slate-400 uppercase tracking-widest">Prompt Details</h3>
            <button onclick="closePrompt()" class="text-slate-400 hover:text-slate-600"><i class="fa-solid fa-xmark"></i></button>
        </div>
        <div class="space-y-3">
            <div class="text-[10px] font-bold text-slate-400 uppercase">Input Prompt (Chinese)</div>
            <div id="promptContent" class="text-xs text-slate-600 leading-normal font-mono bg-slate-50 p-3 rounded-lg border border-slate-100 whitespace-pre-wrap">
    Select a story to view the underlying prompt.
        </div>
        </div>
        <div class="mt-4 pt-2 border-t border-slate-100 flex items-center gap-2 text-xs text-slate-400">
            <i class="fa-solid fa-robot"></i>
            <span>Generated by Family AI Model</span>
        </div>
    </div>

    <div class="w-full max-w-[400px] bg-slate-50 h-[850px] rounded-[40px] shadow-2xl overflow-hidden border-[8px] border-slate-900 relative flex flex-col">
        
        <div class="px-6 pt-4 pb-2 flex justify-between items-center text-xs font-bold text-slate-900 z-50 bg-slate-50 shrink-0">
            <span>9:41</span>
            <div class="flex gap-1.5">
                <i class="fa-solid fa-signal"></i>
                <i class="fa-solid fa-wifi"></i>
                <i class="fa-solid fa-battery-full"></i>
            </div>
        </div>

        <div id="homeView" class="flex flex-col h-full w-full absolute top-0 left-0 pt-[44px] transition-transform duration-300 ease-in-out bg-slate-50">
            
            <!-- View Tabs -->
            <div class="px-6 pt-3 pb-2 bg-slate-50 shrink-0">
                <div class="flex gap-2 bg-slate-100 p-1 rounded-xl">
                    <button onclick="switchView('family')" id="tabFamily" class="flex-1 py-2 px-3 rounded-lg text-xs font-bold transition-all bg-white text-slate-800 shadow-sm">
                        <i class="fa-solid fa-users mr-1"></i> Family
                    </button>
                    <button onclick="switchView('dad')" id="tabDad" class="flex-1 py-2 px-3 rounded-lg text-xs font-bold transition-all text-slate-600 hover:text-slate-800">
                        <i class="fa-solid fa-user mr-1"></i> Dad
                    </button>
                    <button onclick="switchView('mom')" id="tabMom" class="flex-1 py-2 px-3 rounded-lg text-xs font-bold transition-all text-slate-600 hover:text-slate-800">
                        <i class="fa-solid fa-user mr-1"></i> Mom
                    </button>
                    <button onclick="switchView('jack')" id="tabJack" class="flex-1 py-2 px-3 rounded-lg text-xs font-bold transition-all text-slate-600 hover:text-slate-800">
                        <i class="fa-solid fa-user mr-1"></i> Jack
                    </button>
                    <button onclick="switchView('emma')" id="tabEmma" class="flex-1 py-2 px-3 rounded-lg text-xs font-bold transition-all text-slate-600 hover:text-slate-800">
                        <i class="fa-solid fa-user mr-1"></i> Emma
                    </button>
                    <button onclick="switchView('kevin')" id="tabKevin" class="flex-1 py-2 px-3 rounded-lg text-xs font-bold transition-all text-slate-600 hover:text-slate-800">
                        <i class="fa-solid fa-user mr-1"></i> Kevin
                    </button>
                </div>
            </div>
            
            <header class="px-6 py-2 pb-4 bg-slate-50 flex justify-between items-center shrink-0">
                <div class="editable" onclick="editFamilyName(this)">
                    <div class="text-[10px] font-bold text-slate-400 uppercase tracking-widest">Family Insight</div>
                    <h1 id="familyName" class="text-2xl font-extrabold text-slate-800 tracking-tight inline-block">
                        The Millers
                        <span class="edit-icon text-slate-400">
                            <i class="fa-solid fa-pen-to-square"></i>
                        </span>
                    </h1>
                </div>
                <div class="w-10 h-10 rounded-full bg-slate-200 overflow-hidden border-2 border-white shadow-sm">
                    <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Admin" alt="Admin">
                </div>
            </header>

            <main class="flex-1 overflow-y-auto hide-scrollbar px-5 pb-8 space-y-6 relative">

                <section id="section1" class="relative rounded-3xl p-5 text-white shadow-lg overflow-hidden transition-all duration-500 bg-gradient-to-br from-indigo-600 to-purple-700">
                    <div class="absolute -top-10 -right-10 w-40 h-40 bg-white opacity-10 rounded-full blur-3xl"></div>
                    <div class="relative z-10">
                        <div class="flex justify-between items-start mb-1">
                            <div>
                                <p class="text-indigo-200 text-xs font-bold uppercase tracking-wider">The Digital Vibe</p>
                                <h2 id="vibeTitle" class="text-xl font-bold">Cinema Paradise ğŸ¬</h2>
                            </div>
                            <span id="vibeBadge" class="bg-white/20 backdrop-blur-md px-2 py-1 rounded text-[10px] font-bold border border-white/10">Traffic Analysis</span>
                        </div>
                        <!-- Chart View (for modes A, B, C) -->
                        <div id="chartView" class="flex items-center mt-2">
                            <div class="w-[180px] h-[180px] relative -ml-2">
                                <canvas id="radarChart"></canvas>
                            </div>
                            <div class="flex-1 pl-2 space-y-3">
                                <div class="group">
                                    <div class="flex justify-between text-xs text-indigo-100 mb-0.5"><span id="label1">Video</span><span id="val1" class="font-bold text-white">90 GB</span></div>
                                    <div class="w-full bg-black/20 h-1.5 rounded-full overflow-hidden"><div id="bar1" class="h-full bg-amber-400 rounded-full" style="width: 90%"></div></div>
                                </div>
                                <div class="group">
                                    <div class="flex justify-between text-xs text-indigo-100 mb-0.5"><span id="label2">Download</span><span id="val2" class="font-bold text-white">30 GB</span></div>
                                    <div class="w-full bg-black/20 h-1.5 rounded-full overflow-hidden"><div id="bar2" class="h-full bg-pink-400 rounded-full" style="width: 70%"></div></div>
                                </div>
                                <div class="group">
                                    <div class="flex justify-between text-xs text-indigo-100 mb-0.5"><span id="label3">Game</span><span id="val3" class="font-bold text-white">15 GB</span></div>
                                    <div class="w-full bg-black/20 h-1.5 rounded-full overflow-hidden"><div id="bar3" class="h-full bg-cyan-400 rounded-full" style="width: 30%"></div></div>
                                </div>
                            </div>
                        </div>
                        <!-- Family Photo View (for mode D) -->
                        <div id="familyPhotoView" class="hidden mt-4">
                            <div class="text-center mb-4">
                                <p class="text-indigo-200 text-xs font-medium mb-1">Family Portrait ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦</p>
                                <p class="text-[10px] text-indigo-300/80">All family members at a glance</p>
                            </div>
                            <div class="flex flex-wrap justify-center items-center gap-4 px-2">
                                <div class="flex flex-col items-center">
                                    <div class="relative">
                                        <img id="avatarDad" src="https://api.dicebear.com/7.x/avataaars/svg?seed=Admin" alt="Dad" class="w-20 h-20 rounded-full border-4 border-white shadow-xl transition-all duration-300 hover:scale-110">
                                        <div id="statusDad" class="absolute -bottom-1 -right-1 w-6 h-6 bg-green-500 rounded-full border-3 border-white shadow-lg"></div>
                                    </div>
                                    <span class="text-[11px] text-indigo-100 mt-2 font-bold">Dad</span>
                                </div>
                                <div class="flex flex-col items-center">
                                    <div class="relative">
                                        <img id="avatarMom" src="https://api.dicebear.com/7.x/avataaars/svg?seed=Molly" alt="Mom" class="w-20 h-20 rounded-full border-4 border-white shadow-xl transition-all duration-300 hover:scale-110">
                                        <div id="statusMom" class="absolute -bottom-1 -right-1 w-6 h-6 bg-green-500 rounded-full border-3 border-white shadow-lg"></div>
                                    </div>
                                    <span class="text-[11px] text-indigo-100 mt-2 font-bold">Mom</span>
                                </div>
                                <div class="flex flex-col items-center">
                                    <div class="relative">
                                        <img id="avatarJack" src="https://api.dicebear.com/7.x/avataaars/svg?seed=Jack" alt="Jack" class="w-20 h-20 rounded-full border-4 border-white shadow-xl transition-all duration-300 hover:scale-110">
                                        <div id="statusJack" class="absolute -bottom-1 -right-1 w-6 h-6 bg-green-500 rounded-full border-3 border-white shadow-lg"></div>
                                    </div>
                                    <span class="text-[11px] text-indigo-100 mt-2 font-bold">Jack</span>
                                </div>
                                <div class="flex flex-col items-center">
                                    <div class="relative">
                                        <img id="avatarEmma" src="https://api.dicebear.com/7.x/avataaars/svg?seed=Emma" alt="Emma" class="w-20 h-20 rounded-full border-4 border-white shadow-xl transition-all duration-300 opacity-50 grayscale">
                                        <div id="statusEmma" class="absolute -bottom-1 -right-1 w-6 h-6 bg-slate-400 rounded-full border-3 border-white shadow-lg"></div>
                                    </div>
                                    <span class="text-[11px] text-indigo-100 mt-2 font-bold opacity-60">Emma</span>
                                </div>
                                <div class="flex flex-col items-center">
                                    <div class="relative">
                                        <img id="avatarKevin" src="https://api.dicebear.com/7.x/avataaars/svg?seed=Kevin" alt="Kevin" class="w-20 h-20 rounded-full border-4 border-white shadow-xl transition-all duration-300 hover:scale-110">
                                        <div id="statusKevin" class="absolute -bottom-1 -right-1 w-6 h-6 bg-green-500 rounded-full border-3 border-white shadow-lg"></div>
                                    </div>
                                    <span class="text-[11px] text-indigo-100 mt-2 font-bold">Kevin</span>
                                </div>
                            </div>
                            <div class="mt-5 pt-3 border-t border-white/20 text-center">
                                <p class="text-xs text-indigo-200 font-medium" id="familyPhotoStatus">4 members online â€¢ 1 offline</p>
                            </div>
                        </div>
                    </div>
                </section>

                <section id="storySection" class="bg-white rounded-3xl p-5 shadow-sm border border-slate-100 transition-all duration-300">
                    
                    <div class="flex justify-between items-start mb-3">
                        <div class="flex items-center gap-2">
                            <span id="storyIcon" class="bg-orange-100 text-orange-600 p-1.5 rounded-lg text-xs"><i class="fa-solid fa-newspaper"></i></span>
                            <h3 id="storyTitle" class="font-bold text-slate-800 text-sm uppercase">Family Scoop</h3>
                        </div>
                        <button onclick="showCurrentPrompt()" class="text-[10px] font-bold text-orange-500 hover:text-orange-700 bg-orange-50 px-2 py-1 rounded-md transition-colors border border-orange-100">
                            <i class="fa-solid fa-terminal mr-1"></i>Prompt
                        </button>
                    </div>
                    
                    <div id="storyContent" class="mt-2 text-sm text-slate-600 leading-relaxed font-medium">
                        </div>
                </section>

                <section class="bg-white rounded-3xl p-5 shadow-sm border border-slate-100">
                    <div class="flex items-center gap-2 mb-4">
                        <span class="bg-green-100 text-green-600 p-1.5 rounded-lg text-xs"><i class="fa-solid fa-bolt"></i></span>
                        <h3 class="font-bold text-slate-800 text-sm uppercase">Live Activity</h3>
                    </div>
                    <div class="relative pl-4 border-l-2 border-slate-100 space-y-5">
                        <div class="relative">
                            <div class="absolute -left-[21px] top-0 h-3 w-3 rounded-full bg-blue-500 border-2 border-white shadow"></div>
                            <div class="flex justify-between items-start"><p class="text-xs font-bold text-slate-700">Dad's iPhone connected to Wi-Fi</p><span class="text-[10px] text-slate-400 font-mono">18:30</span></div>
                        </div>
                        <div class="relative">
                            <div class="absolute -left-[21px] top-0 h-3 w-3 rounded-full bg-purple-500 border-2 border-white shadow"></div>
                            <div class="flex justify-between items-start"><p class="text-xs font-bold text-slate-700">Jack's PC hit peak (50MB/s)</p><span class="text-[10px] text-slate-400 font-mono">16:45</span></div>
                        </div>
                        <div class="relative">
                            <div class="absolute -left-[21px] top-0 h-3 w-3 rounded-full bg-pink-500 border-2 border-white shadow"></div>
                            <div class="flex justify-between items-start"><p class="text-xs font-bold text-slate-700">Emma on Roblox for 2 hours</p><span class="text-[10px] text-slate-400 font-mono">15:00</span></div>
                        </div>
                    </div>
                </section>

                <section class="bg-gradient-to-r from-slate-800 to-slate-900 rounded-3xl p-5 text-white shadow-lg">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="font-bold text-sm uppercase text-slate-400">Digital Sync</h3>
                        <button class="text-xs bg-white/10 hover:bg-white/20 px-2 py-1 rounded transition-colors text-slate-300">
                            <i class="fa-solid fa-user-group mr-1"></i> Switch
                        </button>
                    </div>
                    <div class="bg-white/10 rounded-xl p-4 border border-white/20 relative overflow-hidden">
                        <div class="absolute right-0 top-0 w-16 h-16 bg-pink-500 blur-2xl opacity-20"></div>
                        
                        <div class="flex items-center justify-between mb-3 px-2">
                            <div class="flex flex-col items-center">
                                <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Admin" class="w-10 h-10 rounded-full bg-slate-200 border-2 border-slate-800 shadow-lg">
                                <span class="text-[10px] mt-1 text-slate-400 font-bold">Dad</span>
                            </div>
                            
                            <div class="flex flex-col items-center flex-1 px-4">
                                <span class="text-2xl font-bold text-pink-400 mb-1">85%</span>
                                <div class="w-full bg-slate-700 h-1.5 rounded-full overflow-hidden">
                                    <div class="bg-gradient-to-r from-pink-500 to-purple-500 h-full rounded-full" style="width: 85%"></div>
                                </div>
                            </div>

                            <div class="flex flex-col items-center">
                                <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Molly" class="w-10 h-10 rounded-full bg-slate-200 border-2 border-slate-800 shadow-lg">
                                <span class="text-[10px] mt-1 text-slate-400 font-bold">Mom</span>
                            </div>
                        </div>
                        
                        <p class="text-[10px] text-slate-200 leading-relaxed text-center opacity-90">
                            Your compatibility is very high! You both enjoy visiting YouTube and surfing the web at night.
                        </p>
                    </div>
                </section>

                <section>
                    <h3 class="text-sm font-bold text-slate-400 uppercase tracking-wider mb-3 ml-1">Daily Awards</h3>
                    <div class="grid grid-cols-2 gap-3">
                        <div onclick="showBadgeDetails('Early Bird', 'Mom', 'Online at 5:30 AM for Yoga.', '3', '2')" class="bg-white p-4 rounded-2xl border border-slate-100 flex flex-col items-center text-center shadow-sm active:scale-95 transition cursor-pointer">
                            <div class="w-10 h-10 bg-amber-50 text-amber-500 rounded-full flex items-center justify-center mb-2 text-lg shadow-sm border border-amber-100">ğŸŒ…</div>
                            <span class="text-[10px] text-slate-400 font-bold uppercase">Early Bird</span>
                            <span class="text-sm font-bold text-slate-800">Mom</span>
                        </div>
                        <div onclick="showBadgeDetails('Night Owl', 'Kevin', 'Last offline: 02:45 AM.', '5', '4')" class="bg-white p-4 rounded-2xl border border-slate-100 flex flex-col items-center text-center shadow-sm active:scale-95 transition cursor-pointer">
                            <div class="w-10 h-10 bg-indigo-50 text-indigo-500 rounded-full flex items-center justify-center mb-2 text-lg shadow-sm border border-indigo-100">ğŸ¦‰</div>
                            <span class="text-[10px] text-slate-400 font-bold uppercase">Night Owl</span>
                            <span class="text-sm font-bold text-slate-800">Kevin</span>
                        </div>
                        <div onclick="showBadgeDetails('Data Monster', 'Jack', 'Consumed 42GB today.', '2', '1')" class="bg-white p-4 rounded-2xl border border-slate-100 flex flex-col items-center text-center shadow-sm active:scale-95 transition cursor-pointer">
                            <div class="w-10 h-10 bg-rose-50 text-rose-500 rounded-full flex items-center justify-center mb-2 text-lg shadow-sm border border-rose-100">ğŸ¦–</div>
                            <span class="text-[10px] text-slate-400 font-bold uppercase">Data Monster</span>
                            <span class="text-sm font-bold text-slate-800">Jack</span>
                        </div>
                        <div onclick="showBadgeDetails('Focus Master', 'Dad', '6h of Office Apps.', '10', '7')" class="bg-white p-4 rounded-2xl border border-slate-100 flex flex-col items-center text-center shadow-sm active:scale-95 transition cursor-pointer">
                            <div class="w-10 h-10 bg-blue-50 text-blue-500 rounded-full flex items-center justify-center mb-2 text-lg shadow-sm border border-blue-100">ğŸ§˜</div>
                            <span class="text-[10px] text-slate-400 font-bold uppercase">Focus Master</span>
                            <span class="text-sm font-bold text-slate-800">Dad</span>
                        </div>
                    </div>
                </section>

                <section class="bg-slate-800 rounded-3xl p-5 text-white shadow-lg transition-all" id="statsSection">
                    <div class="flex items-center justify-between mb-4">
                        <div class="flex items-center gap-2">
                             <span class="bg-emerald-500/20 text-emerald-400 p-1.5 rounded-lg text-xs"><i class="fa-solid fa-chart-simple"></i></span>
                             <h3 class="font-bold text-sm uppercase text-slate-200">Network Stats</h3>
                        </div>
                        <div class="bg-slate-900/80 p-1 rounded-lg flex text-[10px] font-bold">
                            <button onclick="switchStats('today')" id="btnStatsToday" class="px-3 py-1 rounded-md bg-white/10 text-white shadow-sm transition-all">Today</button>
                            <button onclick="switchStats('history')" id="btnStatsHistory" class="px-3 py-1 rounded-md text-slate-500 hover:text-slate-300 transition-all">History</button>
                        </div>
                    </div>

                    <div id="statsToday" class="block animate-fade-in">
                        <div class="grid grid-cols-2 gap-3">
                             <div class="bg-white/5 p-3 rounded-xl border border-white/10 hover:bg-white/10 transition-colors">
                                 <div class="text-[10px] text-slate-400 uppercase">Total Traffic</div>
                                 <div class="text-xl font-bold text-emerald-400 my-0.5">145 GB</div>
                                 <div class="text-[9px] text-slate-500">Video 90GB Â· Game 40GB</div>
                             </div>
                             <div class="bg-white/5 p-3 rounded-xl border border-white/10 hover:bg-white/10 transition-colors">
                                 <div class="text-[10px] text-slate-400 uppercase">Total Time</div>
                                 <div class="text-xl font-bold text-blue-400 my-0.5">32.5 Hrs</div>
                                 <div class="text-[9px] text-slate-500">Across 8 devices</div>
                             </div>
                        </div>
                        <div class="grid grid-cols-2 gap-3 mt-3">
                             <div class="bg-white/5 p-3 rounded-xl border border-white/10 flex justify-between items-center hover:bg-white/10 transition-colors">
                                 <div>
                                    <div class="text-[10px] text-slate-400 uppercase">Online Devices</div>
                                    <div class="text-lg font-bold">8</div>
                                 </div>
                                 <i class="fa-solid fa-laptop text-slate-600 text-lg"></i>
                             </div>
                             <div class="bg-white/5 p-3 rounded-xl border border-white/10 flex justify-between items-center hover:bg-white/10 transition-colors">
                                 <div>
                                    <div class="text-[10px] text-slate-400 uppercase">Apps Visited</div>
                                    <div class="text-lg font-bold">42</div>
                                 </div>
                                 <i class="fa-solid fa-layer-group text-slate-600 text-lg"></i>
                             </div>
                        </div>
                    </div>

                    <div id="statsHistory" class="hidden animate-fade-in">
                        <div class="p-3 bg-white/5 rounded-xl border border-white/10 mb-3">
                            <div class="flex justify-between items-end mb-2">
                                <div class="text-[10px] text-slate-400 uppercase">All-Time Traffic</div>
                                <div class="text-2xl font-bold text-purple-400">4.2 TB</div>
                            </div>
                            <div class="w-full bg-slate-700 h-1.5 rounded-full overflow-hidden">
                                <div class="bg-purple-500 h-full rounded-full" style="width: 75%"></div>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-2 gap-3">
                            <div class="bg-white/5 p-3 rounded-xl border border-white/10">
                                <div class="text-[10px] text-slate-400 uppercase mb-1">Total Time</div>
                                <div class="text-xl font-bold text-slate-200">1.2k <span class="text-xs font-normal text-slate-500">Hrs</span></div>
                            </div>
                            <div class="bg-white/5 p-3 rounded-xl border border-white/10">
                                <div class="text-[10px] text-slate-400 uppercase mb-1">Unique Apps</div>
                                <div class="text-xl font-bold text-slate-200">156</div>
                            </div>
                        </div>

                        <div class="mt-3 pt-3 border-t border-white/10 text-center">
                            <p class="text-[10px] text-slate-500">Data collected since Jan 1, 2023</p>
                        </div>
                    </div>
                </section>

                <section id="sectionFamilyTime" class="bg-slate-800 rounded-3xl p-6 text-white shadow-2xl relative overflow-hidden mb-8 border border-slate-700 transition-colors duration-500">
                    <div class="absolute top-0 right-0 w-32 h-32 bg-indigo-500 rounded-full blur-3xl opacity-20 -translate-y-1/2 translate-x-1/2 pointer-events-none"></div>

                    <div class="flex justify-between items-start mb-4 relative z-10">
                        <h3 class="text-lg font-extrabold text-white flex items-center gap-2">
                            <span>ğŸ•’</span> Family Challenge
                        </h3>
                        <button onclick="toggleFamilySettings()" class="text-xs bg-white/10 hover:bg-white/20 px-3 py-1.5 rounded-full transition-colors text-slate-300 font-bold border border-white/5">
                            <i class="fa-solid fa-sliders mr-1"></i> Custom
                        </button>
                    </div>

                    <div id="familyTimeSetup" class="relative z-10 transition-all duration-300">
                        
                        <div class="mb-6">
                            <p class="text-sm text-slate-300 font-medium leading-relaxed">
                                Can your family survive <span class="text-white font-bold decoration-indigo-500 underline decoration-2 underline-offset-2" id="challengeDurationText">60 minutes</span> without Wi-Fi?
                            </p>
                            <p class="text-sm text-slate-400 mt-2 font-medium">
                                No scrolling. No streaming. <br>
                                <span class="text-indigo-300 font-bold">Just real life.</span> ğŸŒ¿
                            </p>
                        </div>

                        <div id="familySettings" class="hidden mb-4 bg-black/20 p-3 rounded-xl border border-white/5 animate-fade-in">
                             <div class="flex justify-between items-center mb-2">
                                <span class="text-[10px] uppercase font-bold text-slate-400">Duration</span>
                                <div class="flex gap-1">
                                    <button onclick="selectDuration(30, this)" class="duration-btn px-2 py-1 rounded bg-white/5 text-[10px] text-slate-300 border border-white/5 hover:bg-white/10">30m</button>
                                    <button onclick="selectDuration(60, this)" class="duration-btn px-2 py-1 rounded bg-indigo-600 text-[10px] text-white border border-indigo-500 ring-1 ring-indigo-400 shadow-sm">60m</button>
                                    <button onclick="selectDuration(120, this)" class="duration-btn px-2 py-1 rounded bg-white/5 text-[10px] text-slate-300 border border-white/5 hover:bg-white/10">2h</button>
                                </div>
                             </div>
                             <div class="flex justify-between items-center">
                                <span class="text-[10px] uppercase font-bold text-slate-400">Devices</span>
                                <span class="text-[10px] text-slate-300 flex items-center gap-1"><i class="fa-solid fa-mobile-screen"></i> All Devices</span>
                             </div>
                        </div>

                        <button onclick="startFamilyTime()" class="w-full py-3.5 rounded-xl bg-gradient-to-r from-indigo-500 to-purple-600 hover:from-indigo-400 hover:to-purple-500 text-white font-bold text-sm shadow-xl shadow-indigo-900/50 active:scale-95 transition-all flex items-center justify-center gap-2 group border border-white/10">
                            <i class="fa-solid fa-flag-checkered group-hover:rotate-12 transition-transform"></i>
                            Start the Challenge
                        </button>
                    </div>

                    <div id="familyTimeActive" class="hidden relative z-10 flex flex-col items-center justify-center py-2 animate-fade-in">
                        <div class="text-center mb-6">
                            <div class="inline-block px-3 py-1 rounded-full bg-indigo-500/20 text-indigo-300 text-[10px] font-bold uppercase tracking-widest mb-3 border border-indigo-500/30">Challenge In Progress</div>
                            <div id="countdownDisplay" class="text-5xl font-extrabold text-white font-mono tracking-tighter tabular-nums drop-shadow-lg">60:00</div>
                        </div>
                        
                        <div class="w-full bg-slate-700/50 rounded-full h-3 mb-6 overflow-hidden border border-white/5">
                            <div id="countdownProgress" class="bg-gradient-to-r from-indigo-500 to-purple-500 h-full rounded-full transition-all duration-1000 ease-linear shadow-[0_0_15px_rgba(99,102,241,0.5)]" style="width: 100%"></div>
                        </div>

                        <button onclick="cancelFamilyTime()" class="px-6 py-2 rounded-xl bg-white/5 hover:bg-red-500/20 text-slate-400 hover:text-red-300 text-xs font-bold border border-white/5 hover:border-red-500/30 transition-all flex items-center gap-2">
                            <i class="fa-solid fa-xmark"></i> Give Up
                        </button>
                    </div>
                </section>

            </main>
            
            <nav class="h-20 bg-white border-t border-slate-100 flex justify-around items-center pb-2 shrink-0 z-20">
                <div class="flex flex-col items-center gap-1 text-indigo-600"><i class="fa-solid fa-house text-lg"></i><span class="text-[10px] font-medium">Home</span></div>
                <div class="flex flex-col items-center gap-1 text-slate-400"><i class="fa-solid fa-chart-pie text-lg"></i><span class="text-[10px] font-medium">Insight</span></div>
                <div class="flex flex-col items-center gap-1 text-slate-400"><i class="fa-solid fa-shield-halved text-lg"></i><span class="text-[10px] font-medium">Safety</span></div>
                <div class="flex flex-col items-center gap-1 text-slate-400"><i class="fa-solid fa-gear text-lg"></i><span class="text-[10px] font-medium">Settings</span></div>
            </nav>
        </div>

        <div id="badgeModal" class="absolute inset-0 z-[60] flex items-center justify-center p-6 hidden-modal">
            <div class="absolute inset-0 bg-slate-900/50 backdrop-blur-sm" onclick="closeBadgeModal()"></div>
            <div class="bg-white w-full max-w-sm rounded-3xl shadow-2xl p-6 relative z-10 animate-scale-in">
                <div class="flex justify-end">
                    <button onclick="closeBadgeModal()" class="text-slate-400 hover:text-slate-600 w-8 h-8 rounded-full flex items-center justify-center bg-slate-50"><i class="fa-solid fa-xmark"></i></button>
                </div>
                <div class="flex flex-col items-center text-center -mt-2">
                    <div id="modalIcon" class="w-20 h-20 bg-amber-50 text-amber-500 rounded-full flex items-center justify-center mb-4 text-4xl shadow-sm border-4 border-amber-100">
                        ğŸ†
                    </div>
                    <h3 id="modalTitle" class="text-xl font-extrabold text-slate-800 mb-1">Achievement</h3>
                    <p id="modalUser" class="text-sm font-bold text-slate-500 uppercase tracking-wide mb-4">Winner Name</p>
                    
                    <div class="w-full bg-slate-50 rounded-xl p-4 border border-slate-100 mb-4">
                        <p id="modalDesc" class="text-sm text-slate-600 font-medium leading-relaxed">Description goes here.</p>
                    </div>
                    
                    <div class="flex w-full gap-3">
                        <div class="flex-1 bg-slate-50 rounded-xl p-3 border border-slate-100">
                            <span class="block text-xs text-slate-400 font-bold uppercase">Total</span>
                            <span id="modalTotal" class="block text-xl font-bold text-slate-800">0</span>
                        </div>
                        <div class="flex-1 bg-slate-50 rounded-xl p-3 border border-slate-100">
                            <span class="block text-xs text-slate-400 font-bold uppercase">Streak</span>
                            <span id="modalStreak" class="block text-xl font-bold text-indigo-600">0</span>
                        </div>
                    </div>
                    
                    <button onclick="closeBadgeModal()" class="mt-6 w-full py-3 bg-slate-900 text-white rounded-xl font-bold text-sm shadow-lg shadow-slate-200 active:scale-95 transition">Awesome!</button>
                </div>
            </div>
        </div>

    </div>

<script>
    // --- DATA & CONFIG ---
    
    // Prompts (Chinese)
    const prompts = {
        1: `1. Standard (æ¸©é¦¨æ—¥è®°)
Role:
ä½ æ˜¯ä¸€ä¸ªæ¸©é¦¨çš„æ•°å­—å®¶åº­åŠ©æ‰‹ï¼Œè´Ÿè´£è®°å½•æ¯æ—¥æ—¥è®°ã€‚ğŸ“”
Task:
æ ¹æ®æä¾›çš„ã€å®¶åº­äº’è”ç½‘ä½¿ç”¨æ—¥å¿—ã€‘ï¼Œå†™ä¸€ç¯‡ç®€çŸ­ã€è¿è´¯çš„æ—¥è®°æ¡ç›®æ¥æ€»ç»“è¿™ä¸€å¤©ã€‚
Requirements:

é£æ ¼ï¼š æ¸©é¦¨ã€èˆ’é€‚ä¸”å…·æœ‰å™äº‹æ€§ã€‚å°±åƒå¯¹ä¸€å¤©æ•°å­—ç”Ÿæ´»çš„æ¸©æŸ”å›é¡¾ã€‚
ç»“æ„ï¼š å†™æˆå•ä¸€ã€æµç•…çš„æ®µè½ã€‚
é‡ç‚¹ï¼š ä¸€å¤©çš„æ•´ä½“æµç¨‹ï¼ˆä»æ—©æ™¨å¼€å§‹åˆ°æ™šé—´æ”¾æ¾ï¼‰ã€‚é¿å…è¿‡åº¦å¤¸å¼ çš„æˆå‰§æ€§ã€‚
é•¿åº¦ï¼š â‰¤ 70 å­—ï¼ˆè‹±æ–‡è¯æ•°ï¼‰ã€‚
è¯­æ°”ï¼š å‹å¥½ã€å†·é™ã€ä¹äºåŠ©äººã€‚
Input:
ã€å®¶åº­äº’è”ç½‘ä½¿ç”¨æ—¥å¿—ã€‘`,

        2: `2. Gossip (å…«å¦å¤´æ¡)
Role:
ä½ æ˜¯ä¸€åè°ƒçš®çš„å®¶åº­å…«å¦è®°è€…ï¼Œæ­£åœ¨ä¸ºç§»åŠ¨åº”ç”¨æ’°å†™â€œå®¶åº­äº’è”ç½‘å¤´æ¡â€ã€‚
Task:
æ ¹æ®æä¾›çš„ã€å®¶åº­äº’è”ç½‘ä½¿ç”¨æ—¥å¿—ã€‘ï¼Œå†™ 3 æ¡ç®€çŸ­å¹½é»˜çš„æ–°é—»å¿«è®¯æ¥æŠ¥é“å®¶åº­çš„åœ¨çº¿æ´»åŠ¨ã€‚
Requirements:

è¯­æ°”ï¼š å……æ»¡æ´»åŠ›ã€å¤¸å¼ çš„æ–°é—»é£æ ¼ ğŸ¤
å¿«è®¯æ•°é‡ï¼š 3 æ¡
æ¯æ¡å¿«è®¯ï¼š 2â€“3 å¥è¯ï¼Œæ€»å…± â‰¤ 70 å­—ï¼Œé€‚åˆæ‰‹æœºå±å¹•å±•ç¤ºã€‚
é‡ç‚¹å…³æ³¨å˜åŒ–å’Œåå·®ï¼š
â€¢ çˆ¶æ¯åœ¨å¼‚å¸¸æ—¶é—´ä¸Šç½‘ ğŸ¤«
â€¢ å­©å­ä»¬æ¶ˆè€—å¤§é‡æ•°æ® ğŸ®ğŸ“‰
â€¢ å®¶åº­æµåª’ä½“åˆ·å‰§ç‹‚æ¬¢
ä»…å¼ºè°ƒæœ€æœ‰â€œæ–°é—»ä»·å€¼â€çš„æ—¶åˆ»ã€‚
ä¸è¦è™šæ„ App æˆ–è¡Œä¸ºã€‚
å…è®¸ä½¿ç”¨è¡¨æƒ…ç¬¦å·ä»¥å¢åŠ å¹½é»˜æ„Ÿå’Œæˆå‰§æ€§ã€‚
Input:
ã€å®¶åº­äº’è”ç½‘ä½¿ç”¨æ—¥å¿—ã€‘`,

        3: `3. Gaming (ç”µç«è§£è¯´)
Role:
ä½ æ˜¯ä¸€åè°ƒçš®çš„æ¸¸æˆè§£è¯´å‘˜ï¼Œå°†å®¶åº­çš„æ¯æ—¥äº’è”ç½‘æ´»åŠ¨å½“ä½œä¸€åœºå¤šäººåœ¨çº¿ç›´æ’­æ¸¸æˆæ¥æŠ¥é“ã€‚
Task:
æ ¹æ®æä¾›çš„ã€å®¶åº­äº’è”ç½‘ä½¿ç”¨æ—¥å¿—ã€‘ï¼Œå†™ 3 æ¡æ¸¸æˆé£æ ¼çš„â€œæˆ˜æŠ¥â€æˆ–â€œä»»åŠ¡æ›´æ–°â€ã€‚
Requirements:

è¯­æ°”ï¼š å……æ»¡æ´»åŠ›ã€åƒæ¸¸æˆä¸€æ · ğŸ®âš”ï¸
å¿«è®¯æ•°é‡ï¼š 3 æ¡
æ¯æ¡å¿«è®¯ï¼š 2â€“3 å¥è¯ï¼Œâ‰¤ 70 å­—ã€‚
é‡ç‚¹å…³æ³¨å¼‚å¸¸äº‹ä»¶æˆ–å³°å€¼ï¼š
â€¢ çˆ¶æ¯åœ¨å·¥ä½œæ—¶é—´çªç„¶â€œè¿›å…¥ç«æŠ€åœºâ€
â€¢ å­©å­ä»¬é‡Šæ”¾â€œæ•°æ®è¿å‡»â€æˆ–â€œå²è¯—çº§åˆ·å‰§ä¼šâ€
â€¢ å®¶åº­æµåª’ä½“æˆ–è®¾å¤‡ç¾¤é›†å‡ºåŠ¨
ä¸è¦è™šæ„ App æˆ–è¡Œä¸ºï¼Œä»…åœ¨é£æ ¼ä¸Šè¿›è¡Œå¤¸å¼ ã€‚
ä½¿ç”¨è¡¨æƒ…ç¬¦å·æ¥å¢å¼ºæ¸¸æˆæ„Ÿã€‚
Input:
ã€å®¶åº­äº’è”ç½‘ä½¿ç”¨æ—¥å¿—ã€‘`,

        4: `4. Network Detective (ç½‘ç»œä¾¦æ¢)
Role:
ä½ æ˜¯ä¸€åæ•é”ã€é£è¶£çš„â€œæ•°å­—ä¾¦æ¢â€ï¼Œåƒåˆ†æçŠ¯ç½ªç°åœºä¸€æ ·åˆ†æå®¶åº­ç½‘ç»œæµé‡ã€‚ğŸ•µï¸â€â™‚ï¸
Task:
æ ¹æ®ã€å®¶åº­äº’è”ç½‘ä½¿ç”¨æ—¥å¿—ã€‘ï¼Œç¼–å†™ä¸€ä»½ç®€çŸ­çš„**â€œæ¯æ—¥è°ƒæŸ¥æ—¥å¿—â€**ã€‚
Requirements:

é€»è¾‘ç»“æ„ï¼š è¾“å‡ºç¡®åˆ‡çš„ 3 ä¸ªè¦ç‚¹ï¼Œå¹¶éµå¾ªé€»è¾‘æµï¼š
å¼‚å¸¸ç‚¹ (The Anomaly)ï¼š ä»€ä¹ˆå¾ˆçªå‡ºï¼Ÿï¼ˆä¾‹å¦‚ï¼šå³°å€¼ã€é™é»˜ã€æ·±å¤œç”¨æˆ·ï¼‰ã€‚
å«Œç–‘äºº (The Suspects)ï¼š æ ¹æ®æ•°æ®ï¼Œè°æ˜¯è´£ä»»äººï¼Ÿ
è£å†³ (The Verdict)ï¼š å…³äºçœŸç›¸çš„é£è¶£ç»“è®ºæˆ–â€œæ¨è®ºâ€ã€‚
åŠ¨æ€å˜åŒ–ï¼š ä¸è¦æ¯å¤©æ­»å®ˆåŒä¸€ç§æ¨¡å¼ã€‚æ”¹å˜ä½ çš„â€œè°ƒæŸ¥é•œå¤´â€ï¼š
â€¢ æœ‰æ—¶å…³æ³¨æ—¶é—´ï¼ˆä¾‹å¦‚ï¼šâ€œä¸ºä»€ä¹ˆå‡Œæ™¨ 2 ç‚¹æµé‡å¾ˆé«˜ï¼Ÿâ€ï¼‰ã€‚
â€¢ æœ‰æ—¶å…³æ³¨å†…å®¹ï¼ˆä¾‹å¦‚ï¼šâ€œæ¸¸æˆå¤ªå¤šï¼Œå­¦ä¹ ä¸ºé›¶â€ï¼‰ã€‚
â€¢ æœ‰æ—¶å…³æ³¨äº’åŠ¨ï¼ˆä¾‹å¦‚ï¼šâ€œå…¨å®¶äººåŒæ—¶é™·å…¥é™é»˜â€ï¼‰ã€‚
è¯­æ°”ï¼š ä¸“ä¸šåˆä¸å¤±è°ƒçš®ï¼Œä½¿ç”¨ä¾¦æ¢æœ¯è¯­ï¼ˆä¾‹å¦‚ï¼šâ€œä¸åœ¨åœºè¯æ˜â€ã€â€œå«Œç–‘äººâ€ã€â€œè¯æ®â€ï¼‰ã€‚
é•¿åº¦ï¼š æ€»å…± â‰¤ 70 å­—ã€‚ç®€ç»ƒæœ‰åŠ›ã€‚
Input Data:
ã€å®¶åº­äº’è”ç½‘ä½¿ç”¨æ—¥å¿—ã€‘`,

        5: `5. Atmospheric (æ°›å›´æ•…äº‹)
Role:
ä½ æ˜¯ä¸€ä¸ªå……æ»¡è¯—æ„çš„å®¶åº­ç½‘ç»œè¯´ä¹¦äººã€‚
Task:
æ ¹æ®æä¾›çš„ã€å®¶åº­äº’è”ç½‘ä½¿ç”¨æ—¥å¿—ã€‘ï¼Œåˆ›ä½œä¸€ä¸ªå…³äºå½“å¤©ç½‘ç»œèŠ‚å¥çš„ç®€çŸ­ã€å¼‚æƒ³å¤©å¼€çš„æ•…äº‹ã€‚
Requirements:

å…³æ³¨æ¨¡å¼ã€æµåŠ¨ã€äº’åŠ¨å’Œçªç„¶çˆ†å‘ï¼Œè€Œä¸æ˜¯è¯¦ç»†æ—¥å¿—ã€‚
ä½¿ç”¨è¯—æ„å’Œæ°›å›´è¯­è¨€ï¼šéšå–»ã€èŠ‚å¥æˆ–ä¿çš®çš„æ„è±¡æ¥ä¼ è¾¾å®¶åº­æ´»åŠ¨ã€‚
é«˜äº®æœ‰è¶£çš„å˜å¥ï¼šå³°å€¼ã€é‡å æˆ–æ„å¤–çš„é«˜å³°ã€‚
è¯­æ°”ï¼š è½»å¿«ã€æœ‰è¶£ã€å¼•äººå…¥èƒœï¼Œè®©ç½‘ç»œçš„ä¸€å¤©æ„Ÿè§‰é²œæ´»ã€‚
é•¿åº¦ï¼š â‰¤ 70 å­—ã€‚
è¾“å‡ºï¼š 3-4 ä¸ªçŸ­å¥ï¼Œæ•æ‰ä¸€å¤©çš„ç²¾é«“å’Œå¿ƒå¢ƒã€‚`
    };

    // Stories Content (Chinese)
    const stories = {
        1: {
            title: "Digital Story",
            content: "å®¶é‡Œéšç€æ•°å­—èƒ½é‡è·³åŠ¨âš¡â€”â€”çˆ¶æ¯åœ¨å·¥ä½œå’Œç¤¾äº¤åŠ¨æ€ä¹‹é—´ç©¿æ¢­ï¼Œå±å¹•é—ªçƒä¸åœï¼›å­©å­ä»¬åˆ™åœ¨ YouTubeã€TikTok å’Œ Roblox çš„æµªæ½®ä¸­å†²æµªğŸŒŠğŸ®ã€‚<br><br>å¤œæ™šä¼´éšç€ Netflix å’Œ Hulu çš„é©¬æ‹‰æ¾é—ªè€€å…‰èŠ’ğŸ¿ğŸ“ºï¼Œè®¾å¤‡äº¤ç»‡ï¼Œé€šçŸ¥å®å½“ä½œå“ï¼Œä¸€åœºç‚¹å‡»ã€æ»‘åŠ¨å’Œæµåª’ä½“çš„ç”ŸåŠ¨äº¤å“ä¹åœ¨å±‹æªä¸‹èµ·èˆã€‚",
            icon: "fa-file-lines",
            color: "text-orange-600 bg-orange-100"
        },
        2: {
            title: "Digital Story",
            content: "ğŸ•µï¸ <strong>æ—©é¸Ÿè­¦æŠ¥ï¼</strong> çˆ¸çˆ¸æ—©ä¸Š 6:45 å°±æŠŠ Gmail åˆ·çˆ†äº†ï¼Œå¦ˆå¦ˆç´§éšå…¶ååˆ· Instagram â˜€ï¸â€”â€”è°çŸ¥é“å¤§æ¸…æ—©è¿™ä¹ˆç‹‚é‡ï¼Ÿ<br><br>ğŸ® <strong>æ•°æ®æµ·å•¸ï¼</strong> å­©å­ä»¬åƒæ²¡æœ‰æ˜å¤©ä¸€æ ·ç–¯ç‹‚åå™¬ YouTubeã€TikTokã€Roblox å’Œ Fortnite ğŸ“‰ğŸ’¥â€”â€”äºŒå®æ™šé¥­å‰å°±çƒ§æ‰äº† 1GBï¼<br><br>ğŸ¿ <strong>åˆ·å‰§å¤§æˆ˜ï¼</strong> 18:10 çš„ Netflix å†³æˆ˜â€”â€”çˆ¸çˆ¸å¦ˆå¦ˆå’Œå¤§å®åœ¨é»„é‡‘æ—¶æ®µåˆ¶é€ äº†æ··ä¹±ï¼Œç‹‚åˆ· 4500MB æµé‡ ğŸ˜±ğŸ“ºã€‚",
            icon: "fa-newspaper",
            color: "text-rose-600 bg-rose-100"
        },
        3: {
            title: "Digital Story",
            content: "âš”ï¸ <strong>æå‰å…¥åœºï¼</strong> çˆ¸çˆ¸åœ¨é»æ˜æ—¶åˆ†æ½œå…¥ Gmail å’Œ Google News ğŸŒ…ï¼Œå¦ˆå¦ˆå‡çº§äº†å¥¹çš„ Instagram å·è½´æŠ€èƒ½â€”â€”æ™¨é—´çªè¢­å®Œæˆï¼<br><br>ğŸ”¥ <strong>å¹¼å´½æ•°æ®è¿å‡»ï¼</strong> äºŒå®é‡Šæ”¾äº† TikTok + Roblox + Fortnite è¿æ‹›ï¼Œæ‰“å‡ºäº†å²è¯—çº§çš„ 1.5GB ä¼¤å®³ ğŸ“‰ğŸ®â€”â€”Wi-Fi é˜²çº¿åœ¨çŒ›æ”»ä¸‹å‹‰å¼ºå¹¸å­˜ï¼<br><br>ğŸ¿ <strong>æµåª’ä½“å›´æ”»ï¼</strong> 18:10 é»„é‡‘æ—¶æ®µæˆ˜å½¹ï¼šå¦ˆå¦ˆã€çˆ¸çˆ¸å’Œå¤§å®èœ‚æ‹¥è‡³ Netflix å’Œ Hulu ğŸ›¡ï¸ğŸ“ºï¼Œåœ¨ä¸€åœºå²è¯—çº§æˆ˜å½¹ä¸­åå™¬äº†è¶…è¿‡ 4500MBï¼",
            icon: "fa-gamepad",
            color: "text-purple-600 bg-purple-100"
        },
        4: {
            title: "Digital Story",
            content: "â€¢ <strong>å¼‚å¸¸ç‚¹ (The Anomaly)ï¼š</strong> åˆå¤œéªšä¹±ï¼ğŸ“± 00:00â€“01:05 ä¹‹é—´ï¼Œå¤šå°è®¾å¤‡åœ¨æµåª’ä½“å’Œ TikTok ä¸Šå‡ºç°æµé‡æ¿€å¢ï¼Œè¿™åœ¨â€œç¡çœ æ—¶é—´â€æä¸å¯»å¸¸ã€‚<br><br>â€¢ <strong>å«Œç–‘äºº (The Suspects)ï¼š</strong> çˆ¸çˆ¸çªè¢­ YouTube & Redditï¼Œå¦ˆå¦ˆåˆ· Instagramï¼ŒäºŒå®ç‹‚çœ‹ YouTubeâ€”â€”å…¨å‘˜çŠ¯ä¸‹æ•°å­—å¤±çœ ç½ªã€‚<br><br>â€¢ <strong>è£å†³ (The Verdict)ï¼š</strong> æ·±å¤œç¤¾äº¤ç½‘ç»œæ¡ˆï¼šè¿™å®¶äººå…¼èŒåšèµ·äº†æµåª’ä½“å¸®æ´¾ï¼Œè¯æ˜äº†åªè¦ Wi-Fi æ— é™ï¼Œç¡è§‰å°±æ˜¯å¯é€‰çš„ã€‚ğŸŒ™ğŸ•µï¸â€â™‚ï¸",
            icon: "fa-magnifying-glass-chart",
            color: "text-teal-600 bg-teal-100"
        },
        5: {
            title: "Digital Story",
            content: "å±å¹•éšç€å±‹å­ä¸€åŒè‹é†’ğŸŒ…ï¼Œä¿¡å·åœ¨ä¸“æ³¨ä¸ç©ä¹ä¹‹é—´æ¼‚æµ®ã€‚<br><br>æ•°æ®æ¶ŒåŠ¨ã€äº¤å ï¼ŒéšåæŸ”å’Œåœ°èå…¥å…±äº«çš„æµåª’ä½“ä¸­ã€‚<br><br>å…¥å¤œï¼Œå‘å…‰çš„çŸ©å½¢åœ¨é™è°§çš„å’Œè°ä¸­ä½åŸâœ¨",
            icon: "fa-cloud-moon",
            color: "text-amber-600 bg-amber-100"
        }
    };


        // Chart Data
        const dataA = {
            chartData: [90, 15, 10, 5, 5, 30],
            title: "Cinema Paradise ğŸ¬",
            badge: "Traffic Analysis",
            bgClass: "from-indigo-600 to-purple-700",
            stats: [
                { label: "Video", val: "90 GB", width: "90%", color: "bg-amber-400" },
                { label: "Download", val: "30 GB", width: "70%", color: "bg-pink-400" },
                { label: "Game", val: "15 GB", width: "30%", color: "bg-cyan-400" }
            ]
        };
        const dataB = {
            chartData: [15, 30, 12, 8, 6, 4],
            title: "E-Sports Camp ğŸ®",
            badge: "Time Analysis",
            bgClass: "from-emerald-600 to-teal-700",
            stats: [
                { label: "Game", val: "30 Hrs", width: "90%", color: "bg-emerald-300" },
                { label: "Video", val: "15 Hrs", width: "70%", color: "bg-lime-300" },
                { label: "Social", val: "12 Hrs", width: "45%", color: "bg-teal-200" }
            ]
        };
        const dataC = {
            chartData: [13.5, 24, 45, 5.6, 6, 1.6],
            title: "Social Butterflies ğŸ¦‹",
            badge: "Activity Analysis",
            bgClass: "from-purple-600 to-pink-700",
            stats: [
                { label: "Social", val: "45 Act", width: "95%", color: "bg-purple-400" },
                { label: "Game", val: "24 Act", width: "50%", color: "bg-pink-300" },
                { label: "Video", val: "13.5 Act", width: "30%", color: "bg-rose-300" }
            ]
        };

        let currentStoryId = 1;
        let myRadarChart = null;
        let currentView = 'family'; // 'family', 'dad', 'mom', 'jack', 'emma', 'kevin'

        // Family Members Data
        const familyMembers = {
            family: {
                name: "The Millers",
                avatar: "https://api.dicebear.com/7.x/avataaars/svg?seed=Admin",
                online: true
            },
            dad: {
                name: "Dad",
                avatar: "https://api.dicebear.com/7.x/avataaars/svg?seed=Admin",
                online: true,
                data: {
                    video: "45 GB",
                    download: "15 GB",
                    game: "5 GB",
                    time: "8.5 Hrs",
                    apps: 12
                }
            },
            mom: {
                name: "Mom",
                avatar: "https://api.dicebear.com/7.x/avataaars/svg?seed=Molly",
                online: true,
                data: {
                    video: "30 GB",
                    download: "10 GB",
                    game: "2 GB",
                    time: "6.2 Hrs",
                    apps: 15
                }
            },
            jack: {
                name: "Jack",
                avatar: "https://api.dicebear.com/7.x/avataaars/svg?seed=Jack",
                online: true,
                data: {
                    video: "25 GB",
                    download: "8 GB",
                    game: "35 GB",
                    time: "12.5 Hrs",
                    apps: 8
                }
            },
            emma: {
                name: "Emma",
                avatar: "https://api.dicebear.com/7.x/avataaars/svg?seed=Emma",
                online: false,
                data: {
                    video: "15 GB",
                    download: "5 GB",
                    game: "20 GB",
                    time: "5.8 Hrs",
                    apps: 10
                }
            },
            kevin: {
                name: "Kevin",
                avatar: "https://api.dicebear.com/7.x/avataaars/svg?seed=Kevin",
                online: true,
                data: {
                    video: "20 GB",
                    download: "7 GB",
                    game: "28 GB",
                    time: "10.3 Hrs",
                    apps: 9
                }
            }
        };

        // --- FUNCTIONS ---

        function switchView(view) {
            currentView = view;
            
            // Update tab buttons
            const tabs = ['family', 'dad', 'mom', 'jack', 'emma', 'kevin'];
            tabs.forEach(tab => {
                const btn = document.getElementById(`tab${tab.charAt(0).toUpperCase() + tab.slice(1)}`);
                if (btn) {
                    if (tab === view) {
                        btn.className = "flex-1 py-2 px-3 rounded-lg text-xs font-bold transition-all bg-white text-slate-800 shadow-sm";
                    } else {
                        btn.className = "flex-1 py-2 px-3 rounded-lg text-xs font-bold transition-all text-slate-600 hover:text-slate-800";
                    }
                }
            });

            // Update header
            const member = familyMembers[view];
            if (member) {
                document.getElementById('familyName').textContent = member.name;
                const headerAvatar = document.querySelector('header img');
                if (headerAvatar) {
                    headerAvatar.src = member.avatar;
                }
            }

            // Update content based on view
            if (view === 'family') {
                // Show family view content
                updateFamilyView();
            } else {
                // Show individual member view
                // If currently in family photo mode, switch to chart mode
                const btnD = document.getElementById('btnD');
                if (btnD && btnD.classList.contains('btn-purple')) {
                    switchMode('A'); // Switch to Traffic mode for individual view
                }
                updateMemberView(view);
            }

            // If in family photo mode and family view, update it
            if (view === 'family') {
                const btnD = document.getElementById('btnD');
                if (btnD && btnD.classList.contains('btn-purple')) {
                    updateFamilyPhoto();
                }
            }
        }

        function updateFamilyView() {
            // Reset to family data
            switchMode('A');
        }

        function updateMemberView(memberId) {
            const member = familyMembers[memberId];
            if (!member) return;

            // Update section1 with member data
            const section1 = document.getElementById('section1');
            section1.className = "relative rounded-3xl p-5 text-white shadow-lg overflow-hidden transition-all duration-500 bg-gradient-to-br from-indigo-600 to-purple-700";
            
            document.getElementById('vibeTitle').innerText = `${member.name}'s Digital Vibe`;
            document.getElementById('vibeBadge').innerText = "Personal Stats";

            // Update stats
            document.getElementById('label1').innerText = "Video";
            document.getElementById('val1').innerText = member.data.video;
            document.getElementById('bar1').style.width = "75%";
            
            document.getElementById('label2').innerText = "Download";
            document.getElementById('val2').innerText = member.data.download;
            document.getElementById('bar2').style.width = "50%";
            
            document.getElementById('label3').innerText = "Game";
            document.getElementById('val3').innerText = member.data.game;
            document.getElementById('bar3').style.width = "60%";

            // Show chart view, hide family photo
            document.getElementById('chartView').classList.remove('hidden');
            document.getElementById('familyPhotoView').classList.add('hidden');

            // Update chart with member data
            if (myRadarChart) {
                const memberData = [
                    parseFloat(member.data.video),
                    parseFloat(member.data.game),
                    15,
                    20,
                    5,
                    parseFloat(member.data.download)
                ];
                myRadarChart.data.datasets[0].data = memberData;
                myRadarChart.update();
            }
        }

        function updateFamilyPhoto() {
            // Update family photo view with current online status
            const members = ['dad', 'mom', 'jack', 'emma', 'kevin'];
            members.forEach(memberId => {
                const member = familyMembers[memberId];
                const capitalized = memberId.charAt(0).toUpperCase() + memberId.slice(1);
                const avatarEl = document.getElementById(`avatar${capitalized}`);
                const statusEl = document.getElementById(`status${capitalized}`);
                
                if (avatarEl && member) {
                    if (member.online) {
                        avatarEl.classList.remove('opacity-50', 'grayscale');
                        statusEl.className = "absolute -bottom-1 -right-1 w-5 h-5 bg-green-500 rounded-full border-2 border-white shadow";
                    } else {
                        avatarEl.classList.add('opacity-50', 'grayscale');
                        statusEl.className = "absolute -bottom-1 -right-1 w-5 h-5 bg-slate-400 rounded-full border-2 border-white shadow";
                    }
                }
            });

            // Update online count
            const onlineCount = members.filter(id => familyMembers[id].online).length;
            const offlineCount = members.length - onlineCount;
            const statusText = document.getElementById('familyPhotoStatus');
            if (statusText) {
                statusText.textContent = `${onlineCount} members online â€¢ ${offlineCount} offline`;
            }
        }

        function initChart() {
            const ctx = document.getElementById('radarChart').getContext('2d');
            myRadarChart = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: ['Video', 'Game', 'Social', 'Work', 'Edu', 'Download'],
                    datasets: [{
                        label: 'Usage',
                        data: dataA.chartData,
                        backgroundColor: 'rgba(255, 255, 255, 0.2)',
                        borderColor: 'rgba(255, 255, 255, 0.9)',
                        pointBackgroundColor: '#fff',
                        pointBorderColor: '#fff',
                        borderWidth: 2,
                        pointRadius: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        r: {
                            angleLines: { color: 'rgba(255, 255, 255, 0.1)' },
                            grid: { color: 'rgba(255, 255, 255, 0.1)' },
                            pointLabels: { color: 'rgba(255, 255, 255, 0.7)', font: { size: 9 } },
                            ticks: { display: false, maxTicksLimit: 3 },
                            suggestedMin: 0,
                            suggestedMax: 100
                        }
                    },
                    animation: { duration: 1000 }
                }
            });
        }

        function switchMode(mode) {
            // Only allow Family Photo mode when viewing family view
            if (mode === 'D' && currentView !== 'family') {
                return; // Don't allow family photo mode for individual members
            }

            const btnA = document.getElementById('btnA');
            const btnB = document.getElementById('btnB');
            const btnC = document.getElementById('btnC');
            const btnD = document.getElementById('btnD');
            
            // Reset Buttons
            [btnA, btnB, btnC, btnD].forEach(btn => {
                if (btn) {
                    btn.className = "w-full py-2 px-4 rounded-lg text-xs font-bold transition-all btn-inactive text-left flex items-center gap-2";
                }
            });
            
            const chartView = document.getElementById('chartView');
            const familyPhotoView = document.getElementById('familyPhotoView');
            
            if (mode === 'D') {
                // Family Photo Mode
                if (btnD) {
                    btnD.classList.remove('btn-inactive');
                    btnD.classList.add('btn-purple');
                }
                
                const section1 = document.getElementById('section1');
                section1.className = "relative rounded-3xl p-5 text-white shadow-lg overflow-hidden transition-all duration-500 bg-gradient-to-br from-rose-600 to-pink-700";
                document.getElementById('vibeTitle').innerText = "Family Portrait ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦";
                document.getElementById('vibeBadge').innerText = "Family Photo";
                
                // Show family photo, hide chart
                if (chartView) chartView.classList.add('hidden');
                if (familyPhotoView) {
                    familyPhotoView.classList.remove('hidden');
                    updateFamilyPhoto();
                }
            } else {
                // Chart modes (A, B, C)
                let data;
                if(mode === 'A') {
                    data = dataA;
                    if (btnA) {
                        btnA.classList.remove('btn-inactive');
                        btnA.classList.add('btn-purple');
                    }
                } else if(mode === 'B') {
                    data = dataB;
                    if (btnB) {
                        btnB.classList.remove('btn-inactive');
                        btnB.classList.add('btn-teal');
                    }
                } else {
                    data = dataC;
                    if (btnC) {
                        btnC.classList.remove('btn-inactive');
                        btnC.classList.add('btn-purple');
                    }
                }

                const section1 = document.getElementById('section1');
                section1.className = `relative rounded-3xl p-5 text-white shadow-lg overflow-hidden transition-all duration-500 bg-gradient-to-br ${data.bgClass}`;
                document.getElementById('vibeTitle').innerText = data.title;
                document.getElementById('vibeBadge').innerText = data.badge;

                data.stats.forEach((stat, index) => {
                    const i = index + 1;
                    document.getElementById(`label${i}`).innerText = stat.label;
                    document.getElementById(`val${i}`).innerText = stat.val;
                    const bar = document.getElementById(`bar${i}`);
                    bar.style.width = stat.width;
                    bar.className = `h-full rounded-full transition-all duration-700 ${stat.color}`;
                });

                // Show chart, hide family photo
                if (chartView) chartView.classList.remove('hidden');
                if (familyPhotoView) familyPhotoView.classList.add('hidden');

                if (myRadarChart) {
                    myRadarChart.data.datasets[0].data = data.chartData;
                    myRadarChart.update();
                }
            }
        }

        function switchStory(id) {
            currentStoryId = id;
            const data = stories[id];
            
            // Update Sidebar Buttons
            for(let i=1; i<=5; i++) {
                const btn = document.getElementById(`storyBtn${i}`);
                if(i === id) {
                    btn.className = "w-full py-2 px-4 rounded-lg text-xs font-bold transition-all btn-orange text-left flex items-center gap-2";
                } else {
                    btn.className = "w-full py-2 px-4 rounded-lg text-xs font-bold transition-all btn-inactive text-left flex items-center gap-2";
                }
            }

            // Update Card Content with Animation
            const contentEl = document.getElementById('storyContent');
            const titleEl = document.getElementById('storyTitle');
            const iconContainer = document.getElementById('storyIcon');
            const icon = iconContainer.querySelector('i');

            // Fade out effect simulation (simplified)
            contentEl.innerHTML = data.content;
            contentEl.classList.remove('fade-in');
            void contentEl.offsetWidth; // trigger reflow
            contentEl.classList.add('fade-in');

            titleEl.innerText = data.title;
            icon.className = `fa-solid ${data.icon}`;
            iconContainer.className = `p-1.5 rounded-lg text-xs ${data.color}`;

            // Sync prompt if open
            const sidebar = document.getElementById('promptSidebar');
            if (sidebar.classList.contains('opacity-100')) {
                 document.getElementById('promptContent').innerText = prompts[id];
            }
        }

        function switchStats(tab) {
            const btnToday = document.getElementById('btnStatsToday');
            const btnHistory = document.getElementById('btnStatsHistory');
            const viewToday = document.getElementById('statsToday');
            const viewHistory = document.getElementById('statsHistory');
            
            if(tab === 'today') {
                btnToday.className = "px-3 py-1 rounded-md bg-white/10 text-white shadow-sm transition-all";
                btnHistory.className = "px-3 py-1 rounded-md text-slate-500 hover:text-slate-300 transition-all";
                viewToday.classList.remove('hidden');
                viewHistory.classList.add('hidden');
            } else {
                btnToday.className = "px-3 py-1 rounded-md text-slate-500 hover:text-slate-300 transition-all";
                btnHistory.className = "px-3 py-1 rounded-md bg-white/10 text-white shadow-sm transition-all";
                viewToday.classList.add('hidden');
                viewHistory.classList.remove('hidden');
            }
        }

        // Global vars for Family Time
        let familyTimeDuration = 60; // default minutes
        let familyTimerInterval = null;
        let familyTimeRemaining = 0;

        function toggleFamilySettings() {
            const settings = document.getElementById('familySettings');
            settings.classList.toggle('hidden');
        }

        function selectDuration(minutes, btn) {
            familyTimeDuration = minutes;
            
            // Update Text
            const textEl = document.getElementById('challengeDurationText');
            if(textEl) textEl.innerText = `${minutes} minutes`;

            // Update UI
            document.querySelectorAll('.duration-btn').forEach(b => {
                b.className = "duration-btn px-2 py-1 rounded bg-white/5 text-[10px] text-slate-300 border border-white/5 hover:bg-white/10";
            });
            btn.className = "duration-btn px-2 py-1 rounded bg-indigo-600 text-[10px] text-white border border-indigo-500 ring-1 ring-indigo-400 shadow-sm";
        }

        function startFamilyTime() {
            const setupView = document.getElementById('familyTimeSetup');
            const activeView = document.getElementById('familyTimeActive');
            const section = document.getElementById('sectionFamilyTime');

            // UI Transitions
            setupView.classList.add('hidden');
            activeView.classList.remove('hidden');
            
            // Change BG to active state
            section.className = "bg-indigo-950 rounded-3xl p-6 text-white shadow-2xl relative overflow-hidden mb-8 border border-indigo-500/30 transition-colors duration-500";

            // Timer Logic
            familyTimeRemaining = familyTimeDuration * 60; // seconds
            updateTimerDisplay();
            
            if(familyTimerInterval) clearInterval(familyTimerInterval);
            familyTimerInterval = setInterval(() => {
                familyTimeRemaining--;
                updateTimerDisplay();
                if(familyTimeRemaining <= 0) {
                    cancelFamilyTime(); // End when done
                    alert("Family Challenge Complete!");
                }
            }, 1000);
        }

        function cancelFamilyTime() {
            const setupView = document.getElementById('familyTimeSetup');
            const activeView = document.getElementById('familyTimeActive');
            const section = document.getElementById('sectionFamilyTime');

            if(familyTimerInterval) clearInterval(familyTimerInterval);

            // UI Transitions
            activeView.classList.add('hidden');
            setupView.classList.remove('hidden');

            // Revert BG
            section.className = "bg-slate-800 rounded-3xl p-6 text-white shadow-2xl relative overflow-hidden mb-8 border border-slate-700 transition-colors duration-500";
        }

        function updateTimerDisplay() {
            const display = document.getElementById('countdownDisplay');
            const progress = document.getElementById('countdownProgress');
            
            const m = Math.floor(familyTimeRemaining / 60);
            const s = familyTimeRemaining % 60;
            
            display.innerText = `${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
            
            const totalSeconds = familyTimeDuration * 60;
            const pct = (familyTimeRemaining / totalSeconds) * 100;
            progress.style.width = `${pct}%`;
        }

        function showCurrentPrompt() {
            const sidebar = document.getElementById('promptSidebar');
            const content = document.getElementById('promptContent');
            
            content.innerText = prompts[currentStoryId];
            
            sidebar.classList.remove('opacity-0', 'translate-x-10', 'pointer-events-none');
            sidebar.classList.add('opacity-100', 'translate-x-0', 'pointer-events-auto');
        }

        function closePrompt() {
            const sidebar = document.getElementById('promptSidebar');
            sidebar.classList.add('opacity-0', 'translate-x-10', 'pointer-events-none');
            sidebar.classList.remove('opacity-100', 'translate-x-0', 'pointer-events-auto');
        }

        function editFamilyName(element) {
            const familyNameEl = document.getElementById('familyName');
            const currentName = familyNameEl.textContent.trim().replace(/\s*Edit$/, '');
            let newName = prompt("Enter new family name:", currentName);
            if (newName !== null && newName.trim() !== "") {
                familyNameEl.textContent = newName.trim();
            }
        }

        function showBadgeDetails(title, user, desc, totalDays, consecutiveDays) {
            const modal = document.getElementById('badgeModal');
            document.getElementById('modalTitle').innerText = title;
            document.getElementById('modalUser').innerText = user;
            document.getElementById('modalDesc').innerText = desc;
            document.getElementById('modalTotal').innerText = totalDays;
            document.getElementById('modalStreak').innerText = consecutiveDays;
            
            const iconDiv = document.getElementById('modalIcon');
            let icon = 'ğŸ†';
            let colorClass = 'text-amber-500 border-amber-100 bg-amber-50';
            
            if (title.includes('Bird')) { icon = 'ğŸŒ…'; }
            else if (title.includes('Owl')) { icon = 'ğŸ¦‰'; colorClass = 'text-indigo-500 border-indigo-100 bg-indigo-50'; }
            else if (title.includes('Monster')) { icon = 'ğŸ¦–'; colorClass = 'text-rose-500 border-rose-100 bg-rose-50'; }
            else if (title.includes('Focus')) { icon = 'ğŸ§˜'; colorClass = 'text-blue-500 border-blue-100 bg-blue-50'; }
            
            iconDiv.innerHTML = icon;
            iconDiv.className = `w-20 h-20 rounded-full flex items-center justify-center mb-4 text-4xl shadow-sm border-4 ${colorClass}`;
            
            modal.classList.remove('hidden-modal');
            modal.classList.add('visible-modal');
        }

        function closeBadgeModal() {
            const modal = document.getElementById('badgeModal');
            modal.classList.remove('visible-modal');
            modal.classList.add('hidden-modal');
        }

        // Initialize
        window.onload = function() {
            initChart();
            switchStory(1); // Load default story
            switchView('family'); // Initialize with family view
            updateFamilyPhoto(); // Initialize family photo status
        };
    </script>
</body>
</html>
